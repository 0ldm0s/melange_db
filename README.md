# Melange DB ğŸª

> åŸºäº sled æ¶æ„æ·±åº¦ä¼˜åŒ–çš„ä¸‹ä¸€ä»£é«˜æ€§èƒ½åµŒå…¥å¼æ•°æ®åº“

[![Crates.io](https://img.shields.io/crates/v/melange_db.svg)](https://crates.io/crates/melange_db)
[![Documentation](https://docs.rs/melange_db/badge.svg)](https://docs.rs/melange_db)
[![License](https://img.shields.io/badge/license-LGPLv3-blue.svg)](https://www.gnu.org/licenses/lgpl-3.0.en.html)

## ğŸŒ è¯­è¨€ç‰ˆæœ¬
- [ä¸­æ–‡ç‰ˆ](README.md) | [English](README_en.md) | [æ—¥æœ¬èªç‰ˆ](README_ja.md)

## é¡¹ç›®ç®€ä»‹

Melange DB æ˜¯ä¸€ä¸ªåŸºäº sled æ¶æ„è¿›è¡Œæ·±åº¦æ€§èƒ½ä¼˜åŒ–çš„åµŒå…¥å¼æ•°æ®åº“ï¼Œä¸“æ³¨äºè¶…è¶Š RocksDB çš„æ€§èƒ½è¡¨ç°ã€‚é€šè¿‡ SIMD æŒ‡ä»¤ä¼˜åŒ–ã€æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿå’Œå¸ƒéš†è¿‡æ»¤å™¨ç­‰æŠ€æœ¯ï¼Œå®ç°æè‡´çš„è¯»å†™æ€§èƒ½ã€‚

### ğŸ­ åˆ›æ„æ¥æº

é¡¹ç›®åç§°å’Œè®¾è®¡ç†å¿µæ·±å—å¼—å…°å…‹Â·èµ«ä¼¯ç‰¹çš„ç»å…¸ç§‘å¹»å°è¯´ã€Šæ²™ä¸˜ã€‹(Dune) å¯å‘ï¼š

- **Melange (ç¾ç…è„‚)**: æ²™ä¸˜å®‡å®™ä¸­æœ€çè´µçš„ç‰©è´¨ï¼Œæ˜¯å®‡å®™èˆªè¡Œçš„å…³é”®ï¼Œè±¡å¾ç€æ•°æ®çš„çè´µå’Œä»·å€¼
- **ææƒ§æ˜¯æ€ç»´æ€æ‰‹**: æ­£å¦‚æ²™ä¸˜ä¸­çš„ç»å…¸å°è¯ "I must not fear. Fear is the mind-killer"ï¼Œæˆ‘ä»¬çš„è®¾è®¡å“²å­¦æ˜¯æ¶ˆé™¤å¯¹æ€§èƒ½çš„ææƒ§ï¼Œè¿½æ±‚æè‡´ä¼˜åŒ–
- **é¦™æ–™ä¹‹è·¯**: å¦‚åŒæ²™ä¸˜ä¸­çš„é¦™æ–™è¿è¾“è·¯çº¿ï¼ŒMelange DB æ„å»ºäº†é«˜æ•ˆçš„æ•°æ®æµå’Œå­˜å‚¨è·¯å¾„
- **å¼—é›·æ›¼äººç²¾ç¥**: æ²™æ¼ ä¸­çš„ç”Ÿå­˜ä¸“å®¶ï¼Œä»£è¡¨ç€åœ¨èµ„æºå—é™ç¯å¢ƒä¸‹çš„æè‡´æ€§èƒ½ä¼˜åŒ–

è¿™ç§çµæ„Ÿæ¥æºåæ˜ äº†æˆ‘ä»¬å¯¹æ•°æ®åº“è®¾è®¡çš„æ ¸å¿ƒç†å¿µï¼š**åœ¨æœ‰é™çš„èµ„æºä¸­åˆ›é€ æ— é™çš„ä»·å€¼**ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸš€ æè‡´æ€§èƒ½ä¼˜åŒ–
- **SIMD ä¼˜åŒ–çš„ Key æ¯”è¾ƒ**: åŸºäº ARM64 NEON æŒ‡ä»¤é›†çš„é«˜æ€§èƒ½æ¯”è¾ƒ
- **å¤šçº§å—ç¼“å­˜ç³»ç»Ÿ**: çƒ­/æ¸©/å†·ä¸‰çº§ç¼“å­˜ï¼ŒLRU æ·˜æ±°ç­–ç•¥
- **æ™ºèƒ½å¸ƒéš†è¿‡æ»¤å™¨**: 1% è¯¯åˆ¤ç‡ï¼Œå¿«é€Ÿè¿‡æ»¤ä¸å­˜åœ¨æŸ¥è¯¢
- **é¢„å–æœºåˆ¶**: æ™ºèƒ½é¢„å–ç®—æ³•æå‡é¡ºåºè®¿é—®æ€§èƒ½

### ğŸ”’ å¹¶å‘å®‰å…¨
- **æ— é”æ•°æ®ç»“æ„**: åŸºäº concurrent-map çš„é«˜å¹¶å‘è®¾è®¡
- **çº¿ç¨‹å®‰å…¨**: å®Œå…¨çš„ Send + Sync trait å®ç°
- **åŸå­æ€§ä¿è¯**: ACID å…¼å®¹çš„äº‹åŠ¡æ”¯æŒ

### ğŸ”¥ åŸå­æ“ä½œç»Ÿä¸€æ¶æ„ (é‡å¤§æ€§èƒ½å‡çº§)

> **ç‰ˆæœ¬ v0.2.0**: å¼•å…¥äº†å…¨æ–°çš„åŸå­æ“ä½œç»Ÿä¸€æ¶æ„ï¼Œå½»åº•è§£å†³äº†é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ EBR å†²çªé—®é¢˜ã€‚

#### ğŸš€ ç ´åæ€§å‡çº§è¯´æ˜

**è¿™æ˜¯ä¸€ä¸ªç ´åæ€§çš„æ€§èƒ½å‡çº§**ï¼ŒåŒ…å«ä»¥ä¸‹é‡å¤§æ”¹è¿›ï¼š

âœ… **è§£å†³çš„é—®é¢˜**:
- **EBR RefCell å†²çª**: å½»åº•è§£å†³äº†å¤šçº¿ç¨‹é«˜å¹¶å‘æ“ä½œæ—¶çš„ `RefCell already borrowed` panic
- **æ•°æ®ç«äº‰**: æ¶ˆé™¤äº†åŸå­æ“ä½œå’Œæ•°æ®åº“æ“ä½œä¹‹é—´çš„ç«äº‰æ¡ä»¶
- **æ€§èƒ½ç“¶é¢ˆ**: é€šè¿‡ Worker é—´é€šä¿¡å¤§å¹…æå‡å¹¶å‘æ€§èƒ½

âš ï¸ **API å˜æ›´**:
- `atomic_operations_manager::AtomicOperationsManager` - å…¨æ–°ç»Ÿä¸€è·¯ç”±å™¨è®¾è®¡
- `atomic_worker::AtomicWorker` - é‡æ„ä¸ºå®Œå…¨ç‹¬ç«‹çš„åŸå­æ“ä½œç»„ä»¶
- `database_worker::DatabaseWorker` - æ–°å¢ä¸“ç”¨æ•°æ®åº“æ“ä½œ Worker

#### ğŸ—ï¸ æ–°æ¶æ„è®¾è®¡

**SegQueue ç»Ÿä¸€æ¶æ„**:
```
AtomicOperationsManager (çº¯è·¯ç”±å™¨)
    â”œâ”€â”€ SegQueue A â†” AtomicWorker (DashMap + AtomicU64)
    â”‚   â””â”€â”€ è‡ªåŠ¨å‘é€æŒä¹…åŒ–æŒ‡ä»¤ â†’ DatabaseWorkeré˜Ÿåˆ—
    â””â”€â”€ SegQueue B â†” DatabaseWorker (æ‰€æœ‰æ•°æ®åº“æ“ä½œ)
```

#### âœ… æ ¸å¿ƒä¼˜åŠ¿

1. **å®Œå…¨è§£è€¦**:
   - AtomicOperationsManager åªè´Ÿè´£è·¯ç”±ï¼Œä¸æ“ä½œä»»ä½•æ•°æ®ç»“æ„
   - AtomicWorker ä¸“é—¨å¤„ç†åŸå­æ“ä½œï¼Œä¸ç›´æ¥è®¿é—®æ•°æ®åº“
   - DatabaseWorker ä¸“é—¨å¤„ç†æ‰€æœ‰æ•°æ®åº“æ“ä½œ

2. **Workeré—´é€šä¿¡**:
   - AtomicWorker å®Œæˆæ“ä½œåè‡ªåŠ¨å‘ DatabaseWorker å‘é€æŒä¹…åŒ–æŒ‡ä»¤
   - å®Œå…¨é¿å…äº†åŒä¸€çº¿ç¨‹ä¸­çš„ EBR å†²çª

3. **ç»Ÿä¸€ä½¿ç”¨ SegQueue**:
   - æ‰€æœ‰ Worker éƒ½ä½¿ç”¨ç›¸åŒçš„å¹¶å‘é˜Ÿåˆ—æœºåˆ¶
   - ä¸ç°æœ‰æ¶æ„ä¿æŒä¸€è‡´æ€§

#### ğŸ“Š æ€§èƒ½éªŒè¯

**12çº¿ç¨‹é«˜å‹åŠ›æµ‹è¯•ç»“æœ**:
- âœ… **285æ¬¡åŸå­æ“ä½œ**: 160 + 50 + 40 + 35æ¬¡é¡µé¢è®¿é—®
- âœ… **570æ¡æ•°æ®åº“è®°å½•**: 300 + 150 + 120æ¡
- âœ… **é›¶ EBR å†²çª**: 12çº¿ç¨‹åŒæ—¶è¿è¡Œå®Œå…¨å®‰å…¨
- âœ… **100%æ•°æ®ä¸€è‡´æ€§**: æ‰€æœ‰è®¡æ•°å™¨å’Œè®°å½•æ•°æ®å®Œå…¨å‡†ç¡®

#### ğŸš€ ä½¿ç”¨ç¤ºä¾‹

```rust
use melange_db::{Db, Config, atomic_operations_manager::AtomicOperationsManager};
use std::sync::Arc;

fn main() -> anyhow::Result<()> {
    // åˆ›å»ºæ•°æ®åº“
    let config = Config::new().path("my_db");
    let db: Db<1024> = config.open()?;

    // åˆ›å»ºç»Ÿä¸€è·¯ç”±å™¨
    let manager = Arc::new(AtomicOperationsManager::new(Arc::new(db)));

    // åŸå­æ“ä½œï¼ˆè‡ªåŠ¨æŒä¹…åŒ–ï¼‰
    let user_id = manager.increment("user_counter".to_string(), 1)?;
    println!("æ–°ç”¨æˆ·ID: {}", user_id);

    // æ•°æ®åº“æ“ä½œ
    manager.insert(b"user:profile", format!("ç”¨æˆ·{}", user_id).as_bytes())?;

    // è·å–è®¡æ•°å™¨
    let counter = manager.get("user_counter".to_string())?;
    println!("ç”¨æˆ·æ€»æ•°: {:?}", counter);

    Ok(())
}
```

#### ğŸ§ª æµ‹è¯•ç”¨ä¾‹

```bash
# åŸºç¡€ç»Ÿä¸€æ¶æ„æµ‹è¯•
cargo run --example segqueue_unified_test

# é«˜å‹åŠ›å¹¶å‘æµ‹è¯• (12çº¿ç¨‹)
cargo run --example high_pressure_segqueue_test

# åŸå­æ“ä½œWorkeræµ‹è¯•
cargo run --example atomic_worker_test
```

#### ğŸ”„ è¿ç§»æŒ‡å—

**æ—§ç‰ˆæœ¬ (v0.1.4 åŠä»¥ä¸‹)**:
```rust
// âŒ å·²åºŸå¼ƒ - ä¼šäº§ç”ŸEBRå†²çª
let db = Arc::new(config.open()?);
// å¤šçº¿ç¨‹ç›´æ¥æ“ä½œdbä¼šå¯¼è‡´RefCellå†²çª
```

**æ–°ç‰ˆæœ¬ (v0.2.0+)**:
```rust
// âœ… æ¨èä½¿ç”¨ - æ— EBRå†²çª
let manager = Arc::new(AtomicOperationsManager::new(Arc::new(config.open()?)));
// é€šè¿‡ç»Ÿä¸€è·¯ç”±å™¨æ“ä½œï¼Œå®Œå…¨çº¿ç¨‹å®‰å…¨
```

#### âš¡ æ€§èƒ½æå‡

- **å¹¶å‘å®‰å…¨**: æ”¯æŒä»»æ„æ•°é‡çš„å¹¶å‘çº¿ç¨‹
- **é›¶å†²çª**: å½»åº•æ¶ˆé™¤ EBR RefCell å€Ÿç”¨é—®é¢˜
- **è‡ªåŠ¨æŒä¹…åŒ–**: åŸå­æ“ä½œå®Œæˆåè‡ªåŠ¨æŒä¹…åŒ–
- **æ•°æ®ä¸€è‡´æ€§**: ä¿è¯é«˜å¹¶å‘ä¸‹çš„æ•°æ®å®Œæ•´æ€§

### ğŸ“¦ é«˜æ•ˆå†…å­˜ç®¡ç†
- **å¢é‡åºåˆ—åŒ–**: å‡å°‘ IO å¼€é”€çš„åºåˆ—åŒ–ç­–ç•¥
- **æ™ºèƒ½ç¼“å­˜ç­–ç•¥**: è‡ªé€‚åº”ç¼“å­˜æ›¿æ¢ç®—æ³•
- **å†…å­˜æ˜ å°„ä¼˜åŒ–**: é«˜æ•ˆçš„æ–‡ä»¶æ˜ å°„æœºåˆ¶

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```rust
use melange_db::{Db, Config};

fn main() -> anyhow::Result<()> {
    // é…ç½®æ•°æ®åº“
    let config = Config::new()
        .path("/path/to/database")
        .cache_capacity_bytes(512 * 1024 * 1024); // 512MB ç¼“å­˜

    // æ‰“å¼€æ•°æ®åº“
    let db: Db<1024> = config.open()?;

    // å†™å…¥æ•°æ®
    let tree = db.open_tree("my_tree")?;
    tree.insert(b"key", b"value")?;

    // è¯»å–æ•°æ®
    if let Some(value) = tree.get(b"key")? {
        println!("Found value: {:?}", value);
    }

    // èŒƒå›´æŸ¥è¯¢
    for kv in tree.range(b"start"..b"end") {
        let (key, value) = kv?;
        println!("{}: {:?}", String::from_utf8_lossy(&key), value);
    }

    Ok(())
}
```

## ğŸ“š ç¤ºä¾‹ä»£ç 

è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹è¯·æŸ¥çœ‹ `examples/` ç›®å½•ï¼š

### ğŸ”¥ åŸå­æ“ä½œç»Ÿä¸€æ¶æ„ (v0.2.0+)
- **SegQueue ç»Ÿä¸€æ¶æ„æµ‹è¯•**: `cargo run --example segqueue_unified_test`
  - å±•ç¤ºæ–°çš„åŸå­æ“ä½œç»Ÿä¸€æ¶æ„
  - éªŒè¯ Worker é—´é€šä¿¡å’Œè‡ªåŠ¨æŒä¹…åŒ–
  - åŒ…å«åŸºç¡€è·¯ç”±åŠŸèƒ½æµ‹è¯•

- **é«˜å‹åŠ›å¹¶å‘æµ‹è¯•**: `cargo run --example high_pressure_segqueue_test`
  - 12çº¿ç¨‹é«˜å¹¶å‘æ··åˆæ“ä½œæµ‹è¯•
  - éªŒè¯é«˜è´Ÿè½½ä¸‹çš„ç³»ç»Ÿç¨³å®šæ€§
  - åŒ…å«ç”¨æˆ·ç³»ç»Ÿã€è®¢å•ç³»ç»Ÿç­‰çœŸå®åœºæ™¯

- **åŸå­æ“ä½œWorkeræµ‹è¯•**: `cargo run --example atomic_worker_test`
  - çº¯åŸå­æ“ä½œWorkeræ€§èƒ½æµ‹è¯•
  - éªŒè¯åŸå­é€’å¢ã€è·å–ã€é‡ç½®åŠŸèƒ½
  - åŒ…å«åŸºç¡€å¹¶å‘æµ‹è¯•

### ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•
- **æ€§èƒ½åŸºå‡†æµ‹è¯•**: `cargo run --example performance_demo`
- **æœ€ä½³å®è·µ**: `cargo run --example best_practices`

### âš ï¸ å·²åºŸå¼ƒç¤ºä¾‹ (v0.1.4 åŠä»¥ä¸‹)
- `simple_atomic_sequence` - å·²è¿ç§»åˆ°æ–°çš„ç»Ÿä¸€æ¶æ„
- `atomic_operations_test` - å­˜åœ¨EBRå†²çªé—®é¢˜ï¼Œå·²åºŸå¼ƒ
- `atomic_mixed_operations` - å­˜åœ¨å¹¶å‘é™åˆ¶ï¼Œå·²åºŸå¼ƒ

### ğŸ”„ è¿ç§»å»ºè®®

**å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ç¤ºä¾‹**:

âŒ **ä¸è¦ä½¿ç”¨** (å­˜åœ¨EBRå†²çª):
```bash
cargo run --example atomic_mixed_operations  # ä¼šå´©æºƒ
cargo run --example simple_atomic_test       # å­˜åœ¨é—®é¢˜
```

âœ… **æ¨èä½¿ç”¨** (æ–°ç»Ÿä¸€æ¶æ„):
```bash
cargo run --example segqueue_unified_test
cargo run --example high_pressure_segqueue_test
cargo run --example atomic_worker_test
```

### å‹ç¼©é…ç½®

Melange DB æ”¯æŒé€šè¿‡ç¼–è¯‘æ—¶ç‰¹æ€§é€‰æ‹©å‹ç¼©ç®—æ³•ï¼Œä»¥é€‚åº”ä¸åŒçš„æ€§èƒ½éœ€æ±‚ï¼š

#### æ— å‹ç¼©æ¨¡å¼ï¼ˆé»˜è®¤ï¼Œæœ€ä½³æ€§èƒ½ï¼‰
```rust
use melange_db::{Db, Config, CompressionAlgorithm};

fn main() -> anyhow::Result<()> {
    // æ— å‹ç¼©é…ç½® - è¿½æ±‚æè‡´æ€§èƒ½
    let config = Config::new()
        .path("/path/to/database")
        .compression_algorithm(CompressionAlgorithm::None)  // æ— å‹ç¼©
        .cache_capacity_bytes(512 * 1024 * 1024); // 512MB ç¼“å­˜

    let db: Db<1024> = config.open()?;

    // è¯»å†™æ“ä½œå°†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæ— å‹ç¼©å¼€é”€
    let tree = db.open_tree("high_performance_tree")?;
    tree.insert(b"key", b"value")?;

    Ok(())
}
```

#### LZ4å‹ç¼©æ¨¡å¼ï¼ˆå¹³è¡¡æ€§èƒ½ä¸å‹ç¼©ç‡ï¼‰
```rust
use melange_db::{Db, Config, CompressionAlgorithm};

fn main() -> anyhow::Result<()> {
    // LZ4å‹ç¼©é…ç½® - å¹³è¡¡æ€§èƒ½å’Œå­˜å‚¨æ•ˆç‡
    let config = Config::new()
        .path("/path/to/database")
        .compression_algorithm(CompressionAlgorithm::Lz4)  // LZ4å‹ç¼©
        .cache_capacity_bytes(512 * 1024 * 1024); // 512MB ç¼“å­˜

    let db: Db<1024> = config.open()?;

    // è·å¾—è‰¯å¥½çš„å‹ç¼©ç‡ï¼ŒåŒæ—¶ä¿æŒè¾ƒé«˜æ€§èƒ½
    let tree = db.open_tree("balanced_tree")?;
    tree.insert(b"key", b"value")?;

    Ok(())
}
```

#### Zstdå‹ç¼©æ¨¡å¼ï¼ˆé«˜å‹ç¼©ç‡ï¼‰
```rust
use melange_db::{Db, Config, CompressionAlgorithm};

fn main() -> anyhow::Result<()> {
    // Zstdå‹ç¼©é…ç½® - è¿½æ±‚æœ€å¤§å‹ç¼©ç‡
    let config = Config::new()
        .path("/path/to/database")
        .compression_algorithm(CompressionAlgorithm::Zstd)  // Zstdå‹ç¼©
        .cache_capacity_bytes(512 * 1024 * 1024); // 512MB ç¼“å­˜

    let db: Db<1024> = config.open()?;

    // è·å¾—æœ€é«˜çš„å‹ç¼©ç‡ï¼Œé€‚åˆå­˜å‚¨å—é™åœºæ™¯
    let tree = db.open_tree("storage_efficient_tree")?;
    tree.insert(b"key", b"value")?;

    Ok(())
}
```

#### ç‰¹æ€§é€‰æ‹©å’ŒéªŒè¯
```rust
use melange_db::config::CompressionAlgorithm;

fn main() -> anyhow::Result<()> {
    // æ£€æŸ¥å¯ç”¨çš„å‹ç¼©ç‰¹æ€§
    let features = CompressionAlgorithm::detect_enabled_features();
    println!("å¯ç”¨çš„å‹ç¼©ç‰¹æ€§: {:?}", features);

    // éªŒè¯ç‰¹æ€§é…ç½®
    if let Some(warning) = CompressionAlgorithm::validate_feature_config() {
        println!("è­¦å‘Š: {}", warning);
    }

    // è·å–å®é™…ä½¿ç”¨çš„ç®—æ³•
    let (algorithm, reason) = CompressionAlgorithm::get_active_algorithm_with_reason();
    println!("ä½¿ç”¨å‹ç¼©ç®—æ³•: {:?}, åŸå› : {}", algorithm, reason);

    Ok(())
}
```

### æœ€ä½³å®è·µé…ç½®

```rust
use melange_db::{Db, Config};

fn main() -> anyhow::Result<()> {
    // ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®
    let mut config = Config::new()
        .path("/path/to/database")
        .cache_capacity_bytes(1024 * 1024 * 1024) // 1GB ç¼“å­˜
        .flush_every_ms(Some(1000)); // 1ç§’ flush é—´éš”

    // å¯ç”¨æ™ºèƒ½ flush ç­–ç•¥
    config.smart_flush_config.enabled = true;
    config.smart_flush_config.base_interval_ms = 1000;
    config.smart_flush_config.min_interval_ms = 100;
    config.smart_flush_config.max_interval_ms = 5000;
    config.smart_flush_config.write_rate_threshold = 5000;
    config.smart_flush_config.accumulated_bytes_threshold = 8 * 1024 * 1024; // 8MB

    let db: Db<1024> = config.open()?;

    // ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‘å
    let users_tree = db.open_tree("users")?;
    let sessions_tree = db.open_tree("sessions")?;

    Ok(())
}
```

## ç¤ºä¾‹ä»£ç 

æˆ‘ä»¬æä¾›äº†å¤šä¸ªç¤ºä¾‹æ¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ä½¿ç”¨ Melange DBï¼š

### ğŸ“Š æ€§èƒ½æµ‹è¯•ç¤ºä¾‹
- **`performance_demo.rs`** - åŸºæœ¬æ€§èƒ½æ¼”ç¤ºå’Œæ™ºèƒ½ flush ç­–ç•¥å±•ç¤º
- **`accurate_timing_demo.rs`** - ç²¾ç¡®è®¡æ—¶åˆ†æï¼ŒåŒ…å« P50/P95/P99 ç»Ÿè®¡

### ğŸ¯ æœ€ä½³å®è·µç¤ºä¾‹
- **`best_practices.rs`** - å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…å«ï¼š
  - ç”¨æˆ·æ•°æ®ç®¡ç†
  - ä¼šè¯å¤„ç†
  - äº‹åŠ¡æ“ä½œ
  - æ‰¹é‡æ’å…¥
  - èŒƒå›´æŸ¥è¯¢
  - æ•°æ®æ¸…ç†

### ğŸ“ æ—¥å¿—ç³»ç»Ÿé›†æˆç¤ºä¾‹
- **`rat_logger_demo.rs`** - å±•ç¤ºå¦‚ä½•é›†æˆ rat_logger æ—¥å¿—ç³»ç»Ÿï¼š
  - æ—¥å¿—åˆå§‹åŒ–é…ç½®
  - æ€§èƒ½è°ƒè¯•è¾“å‡º
  - ç”±è°ƒç”¨è€…æ§åˆ¶æ—¥å¿—è¡Œä¸º

### âš ï¸ é‡è¦è¯´æ˜

**ç¤ºä¾‹ä»£ç ä¼˜åŒ–ç›®æ ‡**: å½“å‰ç¤ºä¾‹ä¸»è¦é’ˆå¯¹ Apple M1 ç­‰é«˜ç«¯ ARM64 è®¾å¤‡ä¼˜åŒ–ï¼Œé…ç½®äº†è¾ƒå¤§çš„ç¼“å­˜ï¼ˆ1GBï¼‰å’Œé€‚ç”¨äºé«˜æ€§èƒ½åœºæ™¯çš„å‚æ•°ã€‚

**ä½ç«¯è®¾å¤‡ä¼˜åŒ–å»ºè®®**: å¦‚æœæ‚¨éœ€è¦åœ¨ Intel Celeron J1800 ç­‰ä½ç«¯ x86 è®¾å¤‡ä¸Šè¿è¡Œï¼Œè¯·å‚è€ƒï¼š
- **æµ‹è¯•æ–‡ä»¶**: `tests/low_end_x86_perf_test.rs`
- **ä¸“ç”¨é…ç½®**: é’ˆå¯¹ 2GB å†…å­˜å’Œ SSE2 æŒ‡ä»¤é›†ä¼˜åŒ–
- **æ€§èƒ½ç›®æ ‡**: å†™å…¥ 9-15 Âµs/æ¡ï¼Œè¯»å– 2-5 Âµs/æ¡

### è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡ŒåŸºæœ¬æ€§èƒ½æ¼”ç¤º
cargo run --example performance_demo

# è¿è¡Œç²¾ç¡®è®¡æ—¶åˆ†æ
cargo run --example accurate_timing_demo

# è¿è¡Œæœ€ä½³å®è·µç¤ºä¾‹
cargo run --example best_practices

# è¿è¡Œæ—¥å¿—ç³»ç»Ÿé›†æˆç¤ºä¾‹
cargo run --example rat_logger_demo

# è¿è¡Œå‹ç¼©ç®—æ³•æ€§èƒ½å¯¹æ¯”ï¼ˆéœ€è¦æŒ‡å®šå‹ç¼©ç‰¹æ€§ï¼‰
cargo run --example macbook_air_m1_compression_none --features compression-none --release
cargo run --example macbook_air_m1_compression_lz4 --features compression-lz4 --release
cargo run --example macbook_air_m1_compression_zstd --features compression-zstd --release
```

### ä½ç«¯è®¾å¤‡é…ç½®å‚è€ƒ

```rust
// é’ˆå¯¹ Intel Celeron J1800 + 2GB å†…å­˜çš„ä¼˜åŒ–é…ç½®
let mut config = Config::new()
    .path("low_end_db")
    .flush_every_ms(None)  // ç¦ç”¨ä¼ ç»Ÿè‡ªåŠ¨flushï¼Œä½¿ç”¨æ™ºèƒ½flush
    .cache_capacity_bytes(32 * 1024 * 1024);  // 32MBç¼“å­˜ï¼Œé€‚åº”2GBå†…å­˜

// ä¼˜åŒ–æ™ºèƒ½flushé…ç½®
config.smart_flush_config = crate::smart_flush::SmartFlushConfig {
    enabled: true,
    base_interval_ms: 100,     // 100msåŸºç¡€é—´éš”
    min_interval_ms: 30,        // 30msæœ€å°é—´éš”
    max_interval_ms: 1500,     // 1.5sæœ€å¤§é—´éš”
    write_rate_threshold: 4000, // 4K ops/secé˜ˆå€¼
    accumulated_bytes_threshold: 2 * 1024 * 1024, // 2MBç´¯ç§¯é˜ˆå€¼
};
```

### ç¤ºä¾‹äº®ç‚¹

âœ… **é…ç½®ä¼˜åŒ–**: å±•ç¤ºå¦‚ä½•æ ¹æ®åº”ç”¨åœºæ™¯è°ƒæ•´ç¼“å­˜å’Œ flush å‚æ•°
âœ… **æ•°æ®å»ºæ¨¡**: æ¼”ç¤ºç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨å’ŒæŸ¥è¯¢æ¨¡å¼
âœ… **æ‰¹é‡æ“ä½œ**: ä»‹ç»é«˜æ•ˆçš„æ•°æ®æ’å…¥å’Œå¤„ç†æŠ€å·§
âœ… **æŸ¥è¯¢ä¼˜åŒ–**: å±•ç¤ºèŒƒå›´æŸ¥è¯¢å’Œå‰ç¼€æŸ¥è¯¢çš„æœ€ä½³å®è·µ
âœ… **äº‹åŠ¡å¤„ç†**: æ¼”ç¤ºå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§
âœ… **æ€§èƒ½ç›‘æ§**: æä¾›æ€§èƒ½ç»Ÿè®¡å’Œç›‘æ§å»ºè®®

## æ€§èƒ½è¡¨ç°

### æ€§èƒ½æµ‹è¯•æ•°æ®

è¯¦ç»†çš„æ€§èƒ½æµ‹è¯•æ•°æ®å’Œç¡¬ä»¶ç¯å¢ƒä¿¡æ¯è¯·æŸ¥çœ‹ï¼š[docs/test_data/index.md](docs/test_data/index.md)

### æ€§èƒ½äº®ç‚¹

- **é«˜ç«¯è®¾å¤‡è¡¨ç°**: åœ¨Apple M1ä¸Šè¾¾åˆ°å†™å…¥1.23 Âµs/æ¡ï¼Œè¯»å–0.42 Âµs/æ¡çš„ä¼˜å¼‚æ€§èƒ½
- **ä½ç«¯è®¾å¤‡ä¼˜åŒ–**: åœ¨Intel Celeron J1800ä¸Šé€šè¿‡æ™ºèƒ½flushä¼˜åŒ–å®ç°å†™å…¥9.13 Âµs/æ¡ï¼Œè¯»å–2.56 Âµs/æ¡
- **ä½åŠŸè€—è®¾å¤‡é€‚é…**: åœ¨æ ‘è“æ´¾3B+ä¸Šå®ç°å†™å…¥39.04 Âµs/æ¡ï¼Œè¯»å–9.06 Âµs/æ¡ï¼ŒæˆåŠŸé€‚é…1GBå†…å­˜+SDå¡å­˜å‚¨ç¯å¢ƒ
- **å¯¹æ¯”ä¼˜åŠ¿**: ç›¸æ¯”RocksDBæœ€é«˜æå‡4å€å†™å…¥æ€§èƒ½
- **è·¨å¹³å°æ”¯æŒ**: ä¼˜åŒ–äº†ARM64å’Œx86_64æ¶æ„çš„æ€§èƒ½è¡¨ç°

### æµ‹è¯•è¦†ç›–

- **ç¡¬ä»¶å¤šæ ·æ€§**: ä»é«˜ç«¯Apple M1ã€ä½ç«¯Intel Celeronåˆ°æ ‘è“æ´¾3B+çš„å®Œæ•´æµ‹è¯•è¦†ç›–
- **ç³»ç»Ÿå…¼å®¹**: macOSå’ŒLinuxå¤šå¹³å°éªŒè¯
- **ä¼˜åŒ–éªŒè¯**: SIMDæŒ‡ä»¤é›†ã€æ™ºèƒ½flushã€ç¼“å­˜ç­–ç•¥ç­‰å¤šç»´åº¦ä¼˜åŒ–æ•ˆæœéªŒè¯
- **æŒç»­æµ‹è¯•**: å®šæœŸæ€§èƒ½å›å½’æµ‹è¯•ç¡®ä¿æ€§èƒ½ç¨³å®šæ€§

## ä¼˜åŒ–æŠ€æœ¯è¯¦è§£

### 1. SIMD ä¼˜åŒ–
- **å¤šå¹³å°æ”¯æŒ**: åŒæ—¶æ”¯æŒ ARM64 NEON å’Œ x86_64 SSE2/AVX2 æŒ‡ä»¤é›†
- **ARM64 NEON**: æ”¯æŒ Apple M1 å’Œæ ‘è“æ´¾ 3b+ ç­‰ARM64è®¾å¤‡
- **x86_64 SSE2**: æ”¯æŒIntel Celeronç­‰ä¸æ”¯æŒAVX2çš„ä½ç«¯x86è®¾å¤‡
- **x86_64 AVX2**: æ”¯æŒç°ä»£Intel/AMDå¤„ç†å™¨ï¼Œ32å­—èŠ‚å‘é‡å¤„ç†
- **è‡ªé€‚åº”æ£€æµ‹**: è¿è¡Œæ—¶è‡ªåŠ¨æ£€æµ‹CPUæ”¯æŒçš„æŒ‡ä»¤é›†å¹¶é€‰æ‹©æœ€ä¼˜å®ç°
- **å°keyä¼˜åŒ–**: é’ˆå¯¹â‰¤16å­—èŠ‚çš„keyä½¿ç”¨å¿«é€Ÿ64ä½æ•´æ•°æ¯”è¾ƒ
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡keyæ¯”è¾ƒæ“ä½œï¼Œæå‡ç¼“å­˜å‘½ä¸­ç‡
- **é™çº§ç­–ç•¥**: ä¸æ”¯æŒSIMDæ—¶ä½¿ç”¨ä¼˜åŒ–çš„æ ‡é‡æ¯”è¾ƒç®—æ³•

### 2. å¸ƒéš†è¿‡æ»¤å™¨
- **å¤šçº§è¿‡æ»¤å™¨**: æ”¯æŒçƒ­/æ¸©/å†·æ•°æ®åˆ†å±‚
- **å¯é…ç½®è¯¯åˆ¤ç‡**: é»˜è®¤ 1%ï¼Œå¯æŒ‰éœ€è°ƒæ•´
- **å¹¶å‘å®‰å…¨**: æ”¯æŒå¤šçº¿ç¨‹åŒæ—¶è®¿é—®

### 3. å—ç¼“å­˜ç³»ç»Ÿ
- **ä¸‰çº§ç¼“å­˜æ¶æ„**: çƒ­/æ¸©/å†·æ•°æ®åˆ†å±‚å­˜å‚¨
- **æ™ºèƒ½é¢„å–**: åŸºäºè®¿é—®æ¨¡å¼çš„é¢„å–ç®—æ³•
- **å‹ç¼©æ”¯æŒ**: è‡ªåŠ¨å‹ç¼©å¤§å—æ•°æ®
- **100% å‘½ä¸­ç‡**: åœ¨æµ‹è¯•åœºæ™¯ä¸‹çš„å®Œç¾è¡¨ç°

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

1. **Tree**: B+ æ ‘ç´¢å¼•ç»“æ„ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢
2. **Leaf**: å¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨å®é™…æ•°æ®
3. **ObjectCache**: å¯¹è±¡ç¼“å­˜ç³»ç»Ÿï¼Œé›†æˆä¼˜åŒ–ç»„ä»¶
4. **Heap**: å †ç®¡ç†å™¨ï¼Œè´Ÿè´£å†…å­˜åˆ†é…
5. **Index**: å¹¶å‘ç´¢å¼•ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®

### ä¼˜åŒ–é›†æˆ

- **é€æ˜ä¼˜åŒ–**: ç”¨æˆ·æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç å³å¯è·å¾—æ€§èƒ½æå‡
- **å‘åå…¼å®¹**: å®Œå…¨å…¼å®¹ sled çš„ API è®¾è®¡
- **æ¸è¿›å¼ä¼˜åŒ–**: å¯ä»¥é€‰æ‹©æ€§å¯ç”¨ç‰¹å®šä¼˜åŒ–åŠŸèƒ½

## é€‚ç”¨åœºæ™¯

- **é«˜é¢‘äº¤æ˜“ç³»ç»Ÿ**: ä½å»¶è¿Ÿè¯»å†™éœ€æ±‚
- **å®æ—¶æ•°æ®åˆ†æ**: é«˜ååé‡æ•°æ®å¤„ç†
- **åµŒå…¥å¼è®¾å¤‡**: èµ„æºå—é™ç¯å¢ƒä¸‹çš„é«˜æ€§èƒ½å­˜å‚¨
- **ç¼“å­˜ç³»ç»Ÿ**: ä½œä¸ºåˆ†å¸ƒå¼ç¼“å­˜çš„åç«¯å­˜å‚¨

## æœ€ä½³å®è·µæŒ‡å—

### ğŸ¯ é…ç½®ä¼˜åŒ–

1. **ç¼“å­˜å¤§å°è®¾ç½®**
   - å°å‹åº”ç”¨/ä½ç«¯è®¾å¤‡: 32MB - 256MB
   - ä¸­å‹åº”ç”¨: 512MB - 1GB
   - å¤§å‹åº”ç”¨/é«˜æ€§èƒ½è®¾å¤‡: 2GB - 4GB+

2. **æ™ºèƒ½ Flush ç­–ç•¥**
   - å¯ç”¨æ™ºèƒ½ flush ä»¥å¹³è¡¡æ€§èƒ½å’Œæ•°æ®å®‰å…¨
   - æ ¹æ®å†™å…¥è´Ÿè½½è°ƒæ•´ flush é—´éš”
   - è®¾ç½®åˆç†çš„ç´¯ç§¯å­—èŠ‚é˜ˆå€¼
   - **ä½ç«¯è®¾å¤‡ä¼˜åŒ–**: å‡å°‘åŸºç¡€é—´éš”ï¼Œæé«˜é¢‘ç‡ï¼Œé™ä½ç´¯ç§¯é˜ˆå€¼
   - **æ ‘è“æ´¾3B+ç‰¹æ®Šä¼˜åŒ–**: å¢åŠ flushé—´éš”åˆ°200msï¼Œé™ä½å†™å…¥é˜ˆå€¼åˆ°2000 ops/secï¼Œé€‚åº”SDå¡å­˜å‚¨ç‰¹æ€§

3. **æ ‘çš„è®¾è®¡**
   - ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‘å
   - åˆç†è®¾è®¡é”®çš„å‰ç¼€ç»“æ„
   - é¿å…å•ä¸ªæ ‘è¿‡å¤§

4. **ç¡¬ä»¶é€‚é…å»ºè®®**
   - **é«˜ç«¯è®¾å¤‡ (Apple M1ç­‰)**: ä½¿ç”¨ç¤ºä¾‹ä¸­çš„1GBç¼“å­˜é…ç½®
   - **ä½ç«¯è®¾å¤‡ (Intel Celeronç­‰)**: å‚è€ƒ `tests/low_end_x86_perf_test.rs` é…ç½®
   - **æ ‘è“æ´¾3B+ç­‰ä½åŠŸè€—ARMè®¾å¤‡**: å‚è€ƒ `tests/raspberry_pi_perf_test.rs` é…ç½®
   - **å†…å­˜å—é™ç¯å¢ƒ**: å‡å°‘ç¼“å­˜å¤§å°ï¼Œä¼˜åŒ–flushç­–ç•¥ï¼Œè€ƒè™‘ä½¿ç”¨å¢é‡åºåˆ—åŒ–

### ğŸ“Š æ€§èƒ½ä¼˜åŒ–

1. **æ‰¹é‡æ“ä½œ**
   - å¤§é‡æ•°æ®æ’å…¥ä½¿ç”¨æ‰¹é‡æ“ä½œ
   - é¿å…é¢‘ç¹çš„å•æ¡æ’å…¥
   - åˆ©ç”¨é¢„çƒ­ä¼˜åŒ–æ€§èƒ½

2. **æŸ¥è¯¢ä¼˜åŒ–**
   - ä½¿ç”¨èŒƒå›´æŸ¥è¯¢è·å–è¿ç»­æ•°æ®
   - åˆ©ç”¨å‰ç¼€æŸ¥è¯¢è¿‡æ»¤æ•°æ®
   - é¿å…å…¨è¡¨æ‰«æ

3. **æ•°æ®ç®¡ç†**
   - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
   - ä½¿ç”¨äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§
   - ç›‘æ§æ•°æ®åº“å¤§å°å’Œæ€§èƒ½

### ğŸ”§ å¼€å‘å»ºè®®

1. **å¼€å‘ç¯å¢ƒ**
   - ä½¿ç”¨è¾ƒå°çš„ç¼“å­˜å¤§å°è¿›è¡Œå¼€å‘
   - å¯ç”¨è°ƒè¯•æ—¥å¿—ç›‘æ§æ€§èƒ½
   - å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•

2. **ç”Ÿäº§ç¯å¢ƒ**
   - æ ¹æ®å®é™…è´Ÿè½½è°ƒæ•´é…ç½®å‚æ•°
   - ç›‘æ§å…³é”®æ€§èƒ½æŒ‡æ ‡
   - å»ºç«‹æ•°æ®å¤‡ä»½æœºåˆ¶

3. **æµ‹è¯•ç­–ç•¥**
   - è¿›è¡Œå‹åŠ›æµ‹è¯•éªŒè¯æ€§èƒ½
   - æµ‹è¯•æ•…éšœæ¢å¤èƒ½åŠ›
   - éªŒè¯æ•°æ®ä¸€è‡´æ€§

## å¼€å‘è·¯çº¿

### âœ… å·²å®Œæˆä¼˜åŒ–
- [x] SIMD ä¼˜åŒ–çš„ key æ¯”è¾ƒ
- [x] å¤šçº§å¸ƒéš†è¿‡æ»¤å™¨
- [x] æ™ºèƒ½å—ç¼“å­˜ç³»ç»Ÿ
- [x] å¢é‡åºåˆ—åŒ–ä¼˜åŒ–
- [x] å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- [x] æ™ºèƒ½è‡ªé€‚åº” flush ç­–ç•¥
- [x] å®Œæ•´çš„ç¤ºä¾‹ä»£ç å’Œæ–‡æ¡£
- [x] æ™ºèƒ½é¢„å–ç®—æ³•ï¼ˆåŸºäºè®¿é—®æ¨¡å¼ï¼‰
- [x] å®Œæ•´çš„å¤šå¹³å°SIMDæ”¯æŒï¼ˆARM64 NEON + x86_64 SSE2/AVX2ï¼‰
- [x] LZ4å‹ç¼©ç®—æ³•æ”¯æŒï¼ˆç‰¹æ€§å¯é€‰ï¼Œæä¾›æ›´å¿«çš„å‹ç¼©é€Ÿåº¦ï¼‰
- [x] å¤šå‹ç¼©ç®—æ³•ç‰¹æ€§é€‰æ‹©ï¼ˆæ— å‹ç¼©/LZ4/Zstdï¼Œç¼–è¯‘æ—¶ç‰¹æ€§æ§åˆ¶ï¼‰
- [x] å‹ç¼©ç®—æ³•æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•æ•°æ®æ”¶é›†
- [x] Apple Silicon M1ä¸“é¡¹ä¼˜åŒ–å’Œæ€§èƒ½éªŒè¯
- [x] é›†æˆ rat_logger é«˜æ€§èƒ½æ—¥å¿—ç³»ç»Ÿï¼Œæ”¯æŒè°ƒç”¨è€…é…ç½®

### ğŸ”„ è¿›è¡Œä¸­
- [ ] è‡ªé€‚åº”å‹ç¼©ç­–ç•¥ï¼ˆè¿è¡Œæ—¶æ ¹æ®æ•°æ®ç‰¹å¾é€‰æ‹©å‹ç¼©ç®—æ³•ï¼‰

### ğŸ“‹ ä¸‹ä¸€é˜¶æ®µå¼€å‘è®¡åˆ’ï¼ˆv0.2.0ï¼‰

#### ğŸ¯ æ€§èƒ½ä¼˜åŒ–
- [x] **è‡ªé€‚åº”å‹ç¼©ç­–ç•¥** - è¿è¡Œæ—¶æ ¹æ®æ•°æ®ç‰¹å¾è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜å‹ç¼©ç®—æ³•
- [ ] **çƒ­ç‚¹æ•°æ®è¯†åˆ«** - æ™ºèƒ½è¯†åˆ«é«˜é¢‘è®¿é—®æ•°æ®ï¼Œä¼˜åŒ–ç¼“å­˜ç­–ç•¥
- [ ] **å†…å­˜å‹ç¼©** - å¯¹å†·æ•°æ®è¿›è¡Œå†…å­˜å‹ç¼©ï¼Œæé«˜å†…å­˜åˆ©ç”¨ç‡
- [ ] **IOä¼˜åŒ–** - å¼‚æ­¥IOæ”¯æŒï¼Œå‡å°‘é˜»å¡ç­‰å¾…æ—¶é—´
- [ ] **æ‰¹é‡æ“ä½œä¼˜åŒ–** - è¿›ä¸€æ­¥ä¼˜åŒ–æ‰¹é‡æ’å…¥å’ŒæŸ¥è¯¢æ€§èƒ½

#### ğŸ› ï¸ åŠŸèƒ½å¢å¼º
- [ ] **äº‹åŠ¡æ”¯æŒ** - å®Œæ•´çš„ACIDäº‹åŠ¡æ”¯æŒ
- [ ] **èŒƒå›´æŸ¥è¯¢ä¼˜åŒ–** - æ›´é«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢å’Œè¿­ä»£å™¨
- [ ] **äºŒçº§ç´¢å¼•** - æ”¯æŒåˆ›å»ºå’Œç®¡ç†äºŒçº§ç´¢å¼•
- [ ] **æ•°æ®TTL** - è‡ªåŠ¨è¿‡æœŸæ•°æ®æ¸…ç†
- [ ] **å¤‡ä»½æ¢å¤** - æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

#### ğŸ”§ æ¶æ„æ”¹è¿›
- [ ] **æ’ä»¶ç³»ç»Ÿ** - å¯æ‰©å±•çš„æ’ä»¶æ¶æ„
- [ ] **é…ç½®ç®¡ç†** - æ›´çµæ´»çš„é…ç½®ç³»ç»Ÿ
- [ ] **ç›‘æ§æŒ‡æ ‡** - è¯¦ç»†çš„æ€§èƒ½ç›‘æ§å’ŒæŒ‡æ ‡æ”¶é›†
- [ ] **æ—¥å¿—ç³»ç»Ÿ** - ç»“æ„åŒ–æ—¥å¿—å’Œå®¡è®¡åŠŸèƒ½

#### ğŸŒ å¹³å°æ”¯æŒ
- [ ] **Windowsä¼˜åŒ–** - Windowså¹³å°ä¸“é¡¹ä¼˜åŒ–
- [ ] **Androidæ”¯æŒ** - Androidå¹³å°é€‚é…
- [ ] **iOSæ”¯æŒ** - iOSå¹³å°é€‚é…
- [ ] **WebAssembly** - WASMæ”¯æŒï¼Œæµè§ˆå™¨ç¯å¢ƒä½¿ç”¨

#### ğŸ“Š å·¥å…·ç”Ÿæ€
- [ ] **CLIå·¥å…·** - å‘½ä»¤è¡Œç®¡ç†å·¥å…·
- [ ] **Webç•Œé¢** - åŸºäºWebçš„ç®¡ç†ç•Œé¢
- [ ] **æ€§èƒ½åˆ†æ** - æ€§èƒ½åˆ†æå’Œè°ƒä¼˜å·¥å…·
- [ ] **æ•°æ®è¿ç§»** - æ•°æ®å¯¼å…¥å¯¼å‡ºå·¥å…·

### ğŸš€ é•¿æœŸè§„åˆ’ï¼ˆv1.0+ï¼‰

#### åˆ†å¸ƒå¼ç‰ˆæœ¬
- [ ] **é›†ç¾¤æ”¯æŒ** - å¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²
- [ ] **æ•°æ®åˆ†ç‰‡** - è‡ªåŠ¨æ•°æ®åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡
- [ ] **æ•…éšœè½¬ç§»** - è‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œè½¬ç§»
- [ ] **ä¸€è‡´æ€§åè®®** - åˆ†å¸ƒå¼ä¸€è‡´æ€§ä¿è¯

#### é«˜çº§æŸ¥è¯¢ä¼˜åŒ–
- [ ] **æŸ¥è¯¢è®¡åˆ’** - æ™ºèƒ½æŸ¥è¯¢è®¡åˆ’ä¼˜åŒ–
- [ ] **ç´¢å¼•ä¼˜åŒ–** - è‡ªé€‚åº”ç´¢å¼•ç­–ç•¥
- [ ] **ç¼“å­˜ç­–ç•¥** - å¤šçº§ç¼“å­˜ä¼˜åŒ–
- [ ] **é¢„è®¡ç®—** - æŸ¥è¯¢ç»“æœé¢„è®¡ç®—

#### æœºå™¨å­¦ä¹ é›†æˆ
- [ ] **è®¿é—®æ¨¡å¼é¢„æµ‹** - åŸºäºMLçš„è®¿é—®æ¨¡å¼é¢„æµ‹
- [ ] **è‡ªåŠ¨è°ƒä¼˜** - åŸºäºMLçš„å‚æ•°è‡ªåŠ¨è°ƒä¼˜
- [ ] **å¼‚å¸¸æ£€æµ‹** - æ•°æ®è®¿é—®å¼‚å¸¸æ£€æµ‹
- [ ] **å®¹é‡è§„åˆ’** - æ™ºèƒ½å®¹é‡è§„åˆ’å»ºè®®

## æŠ€æœ¯æ ˆ

### å¼€å‘ç¯å¢ƒ
- **æ ¸å¿ƒè¯­è¨€**: Rust 1.70+
- **åŸºç¡€æ¶æ„**: åŸºäº sled ä»£ç åº“
- **å¹¶å‘æ§åˆ¶**: concurrent-map, parking_lot
- **SIMD ä¼˜åŒ–**:
  - std::arch::aarch64 (ARM64 NEONæŒ‡ä»¤é›†)
  - std::arch::x86_64 (x86_64 SSE2/AVX2æŒ‡ä»¤é›†)
- **å‹ç¼©**: zstd, lz4_flexï¼ˆç‰¹æ€§å¯é€‰ï¼‰
- **æ—¥å¿—**: rat_loggerï¼ˆé«˜æ€§èƒ½å¼‚æ­¥æ—¥å¿—ç³»ç»Ÿï¼‰
- **æµ‹è¯•**: criterion, tokio-test

### æ—¥å¿—ç³»ç»Ÿé›†æˆ

Melange DB ç°å·²é›†æˆ rat_logger é«˜æ€§èƒ½æ—¥å¿—ç³»ç»Ÿï¼Œæä¾›çµæ´»çš„æ—¥å¿—é…ç½®é€‰é¡¹ï¼š

#### ä¸»è¦ç‰¹æ€§
- **é«˜æ€§èƒ½å¼‚æ­¥æ—¥å¿—**: åŸºäº rat_logger çš„é«˜æ€§èƒ½å¼‚æ­¥æ—¥å¿—æ¶æ„
- **è°ƒç”¨è€…é…ç½®**: åº“æœ¬èº«ä¸åˆå§‹åŒ–æ—¥å¿—ï¼Œç”±è°ƒç”¨è€…æ§åˆ¶æ—¥å¿—è¡Œä¸º
- **å¤šç§è¾“å‡ºæ–¹å¼**: æ”¯æŒç»ˆç«¯è¾“å‡ºã€æ–‡ä»¶è®°å½•ã€ç½‘ç»œä¼ è¾“ç­‰å¤šç§æ—¥å¿—æ–¹å¼
- **æ€§èƒ½ä¼˜åŒ–**: åœ¨ release æ¨¡å¼ä¸‹ï¼Œè°ƒè¯•çº§åˆ«æ—¥å¿—å®Œå…¨é›¶æˆæœ¬
- **å®‰å…¨è®¾è®¡**: æœªåˆå§‹åŒ–æ—¥å¿—æ—¶é™é»˜å¿½ç•¥ï¼Œä¸ä¼šå½±å“ç¨‹åºæ­£å¸¸è¿è¡Œ

#### åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹
```rust
use melange_db::{Db, Config};
use rat_logger::{LoggerBuilder, LevelFilter, handler::term::TermConfig};

fn main() -> anyhow::Result<()> {
    // åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ - ç”±è°ƒç”¨è€…é…ç½®
    LoggerBuilder::new()
        .add_terminal_with_config(TermConfig::default())
        .with_level(LevelFilter::Debug)
        .init()?;

    // é…ç½®å¹¶æ‰“å¼€æ•°æ®åº“
    let config = Config::new()
        .path("example_db")
        .cache_capacity_bytes(1024 * 1024); // 1MB ç¼“å­˜

    let db: Db<1024> = config.open()?;

    // æ•°æ®åº“æ“ä½œå°†è‡ªåŠ¨è¾“å‡ºæ—¥å¿—
    let tree = db.open_tree("my_tree")?;
    tree.insert(b"key", b"value")?;

    Ok(())
}
```

#### æ—¥å¿—çº§åˆ«è¯´æ˜
- **ERROR**: ä¸¥é‡é”™è¯¯ï¼Œæ€»æ˜¯è®°å½•
- **WARN**: è­¦å‘Šä¿¡æ¯ï¼Œæ€»æ˜¯è®°å½•
- **INFO**: é‡è¦ä¿¡æ¯ï¼Œåœ¨ debug æ¨¡å¼ä¸‹è®°å½•
- **DEBUG**: è°ƒè¯•ä¿¡æ¯ï¼Œåœ¨ debug æ¨¡å¼ä¸‹è®°å½•
- **TRACE**: è¿½è¸ªä¿¡æ¯ï¼Œåœ¨ debug æ¨¡å¼ä¸‹è®°å½•

#### é«˜çº§é…ç½®ç¤ºä¾‹
```rust
use rat_logger::{LoggerBuilder, LevelFilter, handler::{
    term::TermConfig,
    file::FileConfig,
    composite::CompositeHandler
}};

// åŒæ—¶è¾“å‡ºåˆ°ç»ˆç«¯å’Œæ–‡ä»¶
let mut handler = CompositeHandler::new();
handler.add_handler(Box::new(TermProcessor::new(TermConfig::default())?));
handler.add_handler(Box::new(FileProcessor::new(FileConfig {
    file_path: "melange_db.log".to_string(),
    rotation_size_mb: 100,
    max_files: 5,
})?));

LoggerBuilder::new()
    .add_custom_handler(handler)
    .with_level(LevelFilter::Info)
    .init()?;
```

#### âš ï¸ å®‰å…¨ä¿è¯

**æœªåˆå§‹åŒ–æ—¥å¿—æ—¶çš„è¡Œä¸º**:
- âœ… **å®Œå…¨å®‰å…¨**: å¦‚æœè°ƒç”¨è€…æ²¡æœ‰åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿï¼Œæ‰€æœ‰æ—¥å¿—è°ƒç”¨ä¼šè¢«é™é»˜å¿½ç•¥
- âœ… **é›¶å¼‚å¸¸**: ä¸ä¼šäº§ç”Ÿpanicã€é”™è¯¯æˆ–ä»»ä½•è¿è¡Œæ—¶å¼‚å¸¸
- âœ… **æ­£å¸¸æ‰§è¡Œ**: ç¨‹åºä¼šå®Œå…¨æ­£å¸¸è¿è¡Œï¼Œåªæ˜¯æ²¡æœ‰æ—¥å¿—è¾“å‡º
- âœ… **é›¶å¼€é”€**: åœ¨releaseæ¨¡å¼ä¸‹ï¼Œè°ƒè¯•çº§åˆ«æ—¥å¿—æœ¬æ¥å°±æ˜¯é›¶æˆæœ¬çš„
- âœ… **å‘åå…¼å®¹**: æ—§ä»£ç ä¸åˆå§‹åŒ–æ—¥å¿—ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œ

è¿™ç§è®¾è®¡ç¡®ä¿äº†:
- **æ¸è¿›å¼é‡‡ç”¨**: å¯ä»¥é€‰æ‹©æ€§ä¸ºç‰¹å®šæ¨¡å—å¯ç”¨æ—¥å¿—
- **ç”Ÿäº§ç¯å¢ƒå‹å¥½**: åœ¨ä¸éœ€è¦æ—¥å¿—æ—¶å®Œå…¨é›¶å¼€é”€
- **è°ƒç”¨è€…å®Œå…¨æ§åˆ¶**: å®Œå…¨ç”±è°ƒç”¨è€…å†³å®šæ˜¯å¦éœ€è¦æ—¥å¿—åŠŸèƒ½

```rust
// å³ä½¿ä¸åˆå§‹åŒ–æ—¥å¿—ï¼Œä»¥ä¸‹ä»£ç ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œ
use melange_db::{Db, Config};

fn main() -> anyhow::Result<()> {
    // æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰åˆå§‹åŒ–rat_loggerï¼

    let config = Config::new()
        .path("example_db")
        .cache_capacity_bytes(1024 * 1024);

    let db: Db<1024> = config.open()?;
    let tree = db.open_tree("my_tree")?;
    tree.insert(b"key", b"value")?;  // æ—¥å¿—è°ƒç”¨è¢«é™é»˜å¿½ç•¥
    Ok(())
}
```

### å‹ç¼©ç®—æ³•é€‰æ‹©ï¼ˆç¼–è¯‘æ—¶ç‰¹æ€§ï¼‰

Melange DB æ”¯æŒé€šè¿‡ç¼–è¯‘æ—¶ç‰¹æ€§é€‰æ‹©å‹ç¼©ç®—æ³•ï¼Œä»¥é€‚åº”ä¸åŒçš„æ€§èƒ½éœ€æ±‚ï¼š

#### æ— å‹ç¼©ï¼ˆé»˜è®¤ï¼‰
```bash
cargo build --release
```
- **é€‚ç”¨åœºæ™¯**: ä½ç«¯è®¾å¤‡ï¼ˆå¦‚æ ‘è“æ´¾ï¼‰ã€è¿½æ±‚æè‡´æ€§èƒ½
- **ç‰¹ç‚¹**: é›¶CPUå¼€é”€ï¼Œæœ€å¿«è¯»å†™é€Ÿåº¦

#### LZ4å‹ç¼©
```bash
cargo build --release --features compression-lz4
```
- **é€‚ç”¨åœºæ™¯**: ä¸­ç­‰æ€§èƒ½è®¾å¤‡ï¼Œéœ€è¦è¾ƒå¥½çš„å‹ç¼©é€Ÿåº¦å’Œå‹ç¼©ç‡å¹³è¡¡
- **ç‰¹ç‚¹**: æå¿«çš„å‹ç¼©/è§£å‹ç¼©é€Ÿåº¦ï¼Œé€‚åº¦å‹ç¼©ç‡

#### Zstdå‹ç¼©
```bash
cargo build --release --features compression-zstd
```
- **é€‚ç”¨åœºæ™¯**: å­˜å‚¨ç©ºé—´å—é™ï¼Œéœ€è¦é«˜å‹ç¼©ç‡
- **ç‰¹ç‚¹**: é«˜å‹ç¼©ç‡ï¼Œä½†CPUå¼€é”€ç›¸å¯¹è¾ƒå¤§

#### ç‰¹æ€§ä¼˜å…ˆçº§
å¦‚æœåŒæ—¶å¯ç”¨å¤šä¸ªå‹ç¼©ç‰¹æ€§ï¼Œå°†æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§é€‰æ‹©ï¼š**none > lz4 > zstd**

#### é…ç½®éªŒè¯
```rust
use melange_db::config::CompressionAlgorithm;

// æ£€æŸ¥å¯ç”¨çš„å‹ç¼©ç‰¹æ€§
let features = CompressionAlgorithm::detect_enabled_features();
println!("å¯ç”¨çš„å‹ç¼©ç‰¹æ€§: {:?}", features);

// éªŒè¯ç‰¹æ€§é…ç½®
if let Some(warning) = CompressionAlgorithm::validate_feature_config() {
    println!("è­¦å‘Š: {}", warning);
}

// è·å–å®é™…ä½¿ç”¨çš„ç®—æ³•
let (algorithm, reason) = CompressionAlgorithm::get_active_algorithm_with_reason();
println!("ä½¿ç”¨å‹ç¼©ç®—æ³•: {:?}, åŸå› : {}", algorithm, reason);
```

### ç›®æ ‡å¹³å°
- **ARM64å¹³å°**: Apple M1, Raspberry Pi 3b+ ç­‰ARM64è®¾å¤‡
- **x86_64å¹³å°**: Intel/AMDå¤„ç†å™¨ï¼Œä»ä½ç«¯åˆ°é«˜ç«¯å…¨è¦†ç›–
- **ç¼–è¯‘ç›®æ ‡**:
  - aarch64-apple-darwin, aarch64-unknown-linux-gnu
  - x86_64-apple-darwin, x86_64-unknown-linux-gnu
- **æŒ‡ä»¤é›†æ”¯æŒ**:
  - ARM64: ARMv8.4-A with NEON SIMD
  - x86_64: SSE2 (åŸºç¡€), AVX2 (ç°ä»£å¤„ç†å™¨)
- **è¿è¡Œæ—¶æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹CPUç‰¹æ€§å¹¶é€‰æ‹©æœ€ä¼˜SIMDå®ç°

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ GNU Lesser General Public License v3.0 (LGPLv3) è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

### è®¸å¯è¯è¯´æ˜

é€‰æ‹© LGPLv3 çš„åŸå› ï¼š

- **å•†ä¸šå‹å¥½**: å…è®¸å°† Melange DB ç”¨äºå•†ä¸šè½¯ä»¶å’Œé—­æºé¡¹ç›®
- **åŠ¨æ€é“¾æ¥**: é€šè¿‡åŠ¨æ€é“¾æ¥æ–¹å¼ä½¿ç”¨æ—¶ï¼Œä¸»ç¨‹åºå¯ä»¥ä¿æŒé—­æº
- **å¼€æºä¹‰åŠ¡**: ä»…å¯¹åº“æœ¬èº«çš„ä¿®æ”¹éœ€è¦å¼€æºï¼Œä¸å½±å“ä½¿ç”¨æ–¹ä»£ç 
- **ç¤¾åŒºè´¡çŒ®**: ç¡®ä¿æ”¹è¿›å’Œä¼˜åŒ–èƒ½å¤Ÿå›é¦ˆç»™å¼€æºç¤¾åŒº

### ä½¿ç”¨åœºæ™¯

- âœ… **å•†ä¸šè½¯ä»¶**: å¯ä»¥åœ¨é—­æºå•†ä¸šè½¯ä»¶ä¸­ä½¿ç”¨
- âœ… **å¼€æºé¡¹ç›®**: å®Œå…¨å…¼å®¹å…¶ä»–å¼€æºè®¸å¯è¯
- âœ… **åŠ¨æ€é“¾æ¥**: æ¨èçš„ä½¿ç”¨æ–¹å¼ï¼Œä¸»ç¨‹åºä¿æŒé—­æº
- âœ… **ä¿®æ”¹è´¡çŒ®**: å¯¹ Melange DB çš„æ”¹è¿›éœ€è¦å¼€æº

## è‡´è°¢

- åŸºäºä¼˜ç§€çš„ [sled](https://github.com/spacejam/sled) æ•°æ®åº“æ¶æ„
- çµæ„Ÿæ¥è‡ªå¼—å…°å…‹Â·èµ«ä¼¯ç‰¹çš„ã€Šæ²™ä¸˜ã€‹å®‡å®™
- æ„Ÿè°¢æ‰€æœ‰æä¾›åé¦ˆå’Œå»ºè®®çš„è´¡çŒ®è€…å’Œç”¨æˆ·

> "I must not fear. Fear is the mind-killer." - Frank Herbert, Dune